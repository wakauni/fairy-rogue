<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fairy Explorer - Prototype</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ç”¨ã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        #toast-container {
            position: fixed;
            top: 15%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            pointer-events: none;
            width: 90%;
            max-width: 400px;
        }
        .toast-msg {
            background: rgba(0, 0, 0, 0.85);
            color: #fff;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            animation: toastFade 3s forwards;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            white-space: normal !important;
            word-wrap: break-word;
            overflow-wrap: break-word;
            width: auto;
            max-width: 100%;
            box-sizing: border-box;
            text-align: center;
            line-height: 1.4;
        }
        .toast-warning { color: #e74c3c; border-left: 4px solid #e74c3c; }
        .toast-success { color: #2ecc71; border-left: 4px solid #2ecc71; }
        
        @keyframes toastFade {
            0% { opacity: 0; transform: translateY(-10px); }
            10% { opacity: 1; transform: translateY(0); }
            80% { opacity: 1; }
            100% { opacity: 0; pointer-events: none; }
        }
    </style>

<div id="game-container">
    <div id="toast-container"></div>
    <div id="speech-bubble" class="speech-bubble"></div>

    <div id="header-area">
        <div class="status-box">
            <span>HP: <span id="hp-val">100</span> / <span id="max-hp-val">100</span></span>
            <div class="hp-bar-container">
                <div id="hp-bar" class="hp-bar-fill"></div>
            </div>
            <div style="font-size: 12px; margin-top: 4px;">
                ATK:<span id="stat-atk">10</span>
                DEF:<span id="stat-def">5</span>
                INT:<span id="stat-int">15</span>
                SPD:<span id="stat-spd">12</span>
            </div>
        </div>
        <div class="status-box" style="text-align: right; display:flex; flex-direction:column; align-items:flex-end;">
            <div id="floor-display" style="font-size:14px; font-weight:bold; color:#f1c40f; margin-bottom:4px;">Home</div>
            
            <div id="status-icon" style="display:inline-flex; gap:4px; flex-wrap:wrap; justify-content:flex-end; min-height:20px;"></div>
        </div>
    </div>

    <div id="main-view">
        <!-- ã‚²ãƒ¼ãƒ é€²è¡Œç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ (Home, Result, Gameover) -->
        <div id="game-menu-overlay" style="display: none;">
            <div id="menu-title" class="menu-title">HOME</div>
            <div id="menu-content" class="menu-text"></div>
            <div id="loot-display" class="loot-list" style="display:none;"></div>
            <div id="menu-buttons" class="menu-btn-group">
                <!-- JSã§ãƒœã‚¿ãƒ³ç”Ÿæˆ -->
            </div>
        </div>

        <!-- ç·¨æˆç”»é¢ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
        <div id="management-overlay" style="display: none;">
            <div class="mgmt-header">
                <button id="tab-equip" class="mgmt-tab active" onclick="game.switchTab('equip')">è£…å‚™</button>
                <button id="tab-deck" class="mgmt-tab" onclick="game.switchTab('deck')">ãƒ‡ãƒƒã‚­</button>
            </div>
            <div id="mgmt-bonus-indicator" style="background-color: #34495e; color: #ecf0f1; padding: 5px 10px; font-size: 12px; border-bottom: 1px solid #7f8c8d; display: flex; gap: 15px; justify-content: center;">
                <span id="mgmt-bonus-unique" style="opacity: 0.3; transition: 0.3s;">â˜… Technician (INT+5)</span>
                <span id="mgmt-bonus-heavy" style="opacity: 0.3; transition: 0.3s;">â˜… Heavy (DEF+4)</span>
            </div>
            <div id="mgmt-content" class="mgmt-content">
                <!-- JSã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
            <div class="mgmt-footer">
                <div id="mgmt-error-msg" style="font-size: 12px; margin-right: 10px; text-align: right; font-weight: bold;"></div>
                <button id="mgmt-save-btn" class="btn" onclick="game.closeManagement()">æˆ»ã‚‹ (ä¿å­˜)</button>
            </div>
        </div>


        <div id="enemy-intent">
            <span id="intent-icon">âš”ï¸</span>
            <span id="intent-text">æ”»æ’ƒã®äºˆæ„Ÿ...</span>
        </div>
        <div id="enemy-graphic">BOSS</div>

        <div id="battle-loot-area" style="display: none;"></div>
        <div id="battle-log">
            <div class="log-entry">ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³æ·±éƒ¨ã«åˆ°é”ã—ãŸï¼</div>
            <div class="log-entry">å¼·æ•µãŒç¾ã‚ŒãŸï¼</div>
        </div>
    </div>

    <div id="bottom-area">
        <div id="player-area">
            <img id="player-img" src="Fairy_face1.png" alt="Fairy">
        </div>

        <div id="command-area">
            <div id="battle-commands">
                <button class="btn btn-attack" onclick="game.playerAction('attack')">âš”ï¸ æ”»æ’ƒ</button>
                <button class="btn btn-defend" onclick="game.playerAction('defend')">ğŸ›¡ï¸ é˜²å¾¡</button>
                <button class="btn btn-magic" onclick="game.toggleMagicMenu(true)">âœ¨ é­”æ³• (ã‚«ãƒ¼ãƒ‰)</button>
                <button class="btn btn-run" onclick="game.playerAction('run')">ğŸ’¨ é€ƒèµ°</button>

                <div id="card-selection-overlay">
                    <div style="font-weight:bold; margin-bottom:5px;">æ‰‹æœ­ã‚’é¸æŠ:</div>
                    <div id="card-list" class="card-list">
                        </div>
                    <button class="btn close-btn" onclick="game.toggleMagicMenu(false)">æˆ»ã‚‹</button>
                </div>
            </div>
            <div id="system-commands" style="display: none;"></div>
        </div>
    </div>

            <div id="spring-overlay" class="overlay" style="display: none;">
            <div class="overlay-content spring-content">
                <h2 style="color: #4a90e2; text-shadow: 0 0 5px #fff;">å¦–ç²¾ã®æ³‰</h2>
                <div class="spring-desc">
                    æ¸…ã‚‰ã‹ãªé­”åŠ›ãŒæº€ã¡ã¦ã„ã‚‹ã€‚<br>
                    å†’é™ºã®ç–²ã‚Œã‚’ç™’ã‚„ã—ã€è‚‰ä½“ã®å½¢è³ªã‚’å¤‰åŒ–ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã ã€‚
                </div>
    
                <div class="spring-section">
                    <h3>å¤ãå¦–ç²¾ã®çŸ¥æµ</h3>
                    <div id="spring-wisdom-msg" style="font-size:12px; color:#aaa; margin-bottom:5px;">
                        </div>
                    <button id="btn-get-wisdom" class="btn" onclick="game.triggerSpringWisdom()" disabled>
                        âœ¨ çŸ¥æµã‚’æˆã‹ã‚‹ (ã‚«ãƒ¼ãƒ‰ç²å¾—)
                    </button>
                </div>
    
                <hr style="border:0; border-top:1px solid #444; margin: 15px 0;">
    
                <div class="spring-section">
                    <h3>å¤‰æ€§ã®è¡“å¼</h3>
                    <div style="font-size:12px; color:#ccc; margin-bottom:10px;">
                        è‚‰ä½“ã®ã‚µã‚¤ã‚ºã¨é­”åŠ›å—å®¹ä½“ã‚’èª¿æ•´ã—ã¾ã™ã€‚<br>
                        (â€»è†¨å¼µã•ã›ã‚‹å ´åˆã€è¡£æœã¯è„±è¡£çŠ¶æ…‹ã¨ãªã‚Šã¾ã™)
                    </div>
    
                    <div class="status-adjust-row">
                    <span>ç¸®å°åŒ–: </span>
                    <button id="btn-shrink-minus" class="btn-mini" onclick="game.adjustSpringStatus('shrink', -1)">-</button>
                    
                    <span id="spring-shrink-val" style="display:inline-block; width:40px; text-align:center; font-weight:bold;">Lv0</span>
                    
                    <button id="btn-shrink-plus" class="btn-mini" onclick="game.adjustSpringStatus('shrink', 1)">+</button>
                </div>

                <div class="status-adjust-row">
                    <span>è†¨ã€€å¼µ: </span>
                    <button id="btn-expansion-minus" class="btn-mini" onclick="game.adjustSpringStatus('expansion', -1)">-</button>
                    
                    <span id="spring-expansion-val" style="display:inline-block; width:40px; text-align:center; font-weight:bold;">Lv0</span>
                    
                    <button id="btn-expansion-plus" class="btn-mini" onclick="game.adjustSpringStatus('expansion', 1)">+</button>
                </div>
                </div>
    
                <div style="margin-top: 20px;">
                    <button class="btn close-btn" onclick="game.closeSpring()">æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

</div>

<!-- ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®èª­ã¿è¾¼ã¿é †åºãŒé‡è¦ã§ã™ -->
<script src="js/utils.js"></script>
<script src="js/data.js"></script>
<script src="js/Unit.js"></script>
<script src="js/DeckManager.js"></script>
<script src="js/BattleSystem.js"></script>
<script src="js/main.js"></script>
</body>
</html>